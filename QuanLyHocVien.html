<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Case Study</title>
    <style>
        body {
            background-color: #C0D3FA;
        }

        table {
            table-layout: auto;
            background-color: silver;
        / / #C0D3FA;
        }

        th, td {
            width: auto;
            height: auto;
            padding: 5px;
            background-color: lightgreen;
        / / #EB822A;
        / / #ffffff
        }

        .edit-icon {
            color: #005949; /* Màu xanh lá cho biểu tượng Edit */
            font-size: 24px; /* Kích thước biểu tượng */
            cursor: pointer; /* Thay đổi con trỏ khi di chuột qua biểu tượng */
        }

        /* Tùy chỉnh màu sắc của biểu tượng Delete */
        .delete-icon {
            color: #F44336; /* Màu đỏ cho biểu tượng Delete */
            font-size: 24px; /* Kích thước biểu tượng */
            cursor: pointer; /* Thay đổi con trỏ khi di chuột qua biểu tượng */
        }

        /* Thay đổi màu sắc khi di chuột qua biểu tượng */
        .edit-icon:hover, .delete-icon:hover {
            opacity: 0.7; /* Hiệu ứng mờ khi di chuột qua */
        }
    </style>
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
<h2>QUẢN LÝ HỌC VIÊN </h2>

<h4>Thêm mới hoặc Cập nhật học viên </h4>
<table>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Nhập Mã HV</th>
        <td><input type="text" id="mahv" placeholder="Nhập mã học viên..."></td>
    </tr>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Nhập Họ và Tên</th>
        <td><input type="text" id="name" placeholder="Nhập Họ và Tên..."></td>
    </tr>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Nhập Ngày Sinh</th>
        <td><input type="text" id="birthday" placeholder="Nhập Ngày Sinh..."></td>
    </tr>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Giới Tính</th>
        <td><input type="text" id="sex" placeholder="Giới tính..."></td>
    </tr>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Nhập Mã Lớp</th>
        <td><input type="text" id="sclass" placeholder="Lớp cv..."></td>
    </tr>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Chọn Tệp Ảnh</th>
        <td><input type="file" id="photo" accept="image/*"></td>
    </tr>
    <tr>
        <th style="text-align: right; background-color: lightgrey;">Click to</th>
        <td>
            <button onclick="addNewStudent()">AddNew</button>
        </td>
        <td>
            <button onclick="updateStudent()">Update</button>
        </td>
    </tr>
</table>

<h3>Danh Sách tất cả học viên</h3>
<p>Tổng cộng số học viên: <span id="total"></span></p>
<table>
    <thead>
    <tr>
        <th style="text-align: center; background-color: lightgrey;">Stt</th>
        <th style="text-align: center; background-color: lightgrey;">ID</th>
        <th style="text-align: center; background-color: lightgrey;">Họ Và Tên</th>
        <th style="text-align: center; background-color: lightgrey;">Ngày Sinh</th>
        <th style="text-align: center; background-color: lightgrey;">Sex</th>
        <th style="text-align: center; background-color: lightgrey;">Lớp</th>
        <th style="text-align: center; background-color: lightgrey;">Ảnh</th>
        <th colspan="2" style="text-align: center; background-color: lightgrey;">Tùy Chọn</th>
    </tr>
    </thead>
    <tbody id="tbody"></tbody>
</table>

<script>
    class Student {
        constructor(mahv, name, birthday, sex, sclass, photo) {
            this.mahv = mahv;
            this.name = name;
            this.birthday = birthday;
            this.sex = sex;
            this.sclass = sclass;
            this.photo = photo;
        }

        getMahv() {
            return this.mahv;
        }

        getName() {
            return this.name;
        }

        getBirthday() {
            return this.birthday;
        }

        getSex() {
            return this.sex;
        }

        getSclass() {
            return this.sclass;
        }

        getPhoto() {
            return this.photo;
        }
    }

    let array = [
        new Student("0100", "Nguyễn Văn A", "26/09/1994", "M", "cv046", "photo1.jpg"),
        new Student("0101", "Nguyễn Văn B", "17/01/2004", "M", "cv046", "photo2.jpg"),
        new Student("0102", "Nguyễn Văn C", "21/08/2001", "M", "cv045", "photo3.jpg"),
        new Student("0103", "Nguyễn Thị F", "12/11/2009", "F", "cv046", "photo4.jpg"),
        new Student("0104", "Nguyễn Thị G", "15/07/1998", "F", "cv046", "photo5.jpg")
    ];

    function displayStudent(arr) {
        let str = "";
        for (let i = 0; i < arr.length; i++) {
            str += `<tr>
                                <td>${i + 1}</td>
                                <td>${arr[i].getMahv()}</td>
                                <td>${arr[i].getName()}</td>
                                <td>${arr[i].getBirthday()}</td>
                                <td>${arr[i].getSex()}</td>
                                <td>${arr[i].getSclass()}</td>
                                <td><img width="50" height="50" style="object-fit: contain;" src="${arr[i].getPhoto()}" alt="Student Photo"></td>
                                <td><button class="edit-btn" onclick="showUpdate(${i})"><i class='bx bxs-edit-alt edit-icon'></i></button></td>
                                <td><button class="delete-btn" onclick="deleteStudent(${i})"><i class='bx bxs-trash delete-icon'></i></button></td>
                     </tr>`;
        }
        document.getElementById("tbody").innerHTML = str;
        document.getElementById("total").innerText = arr.length;
    }

    function addNewStudent() {
        let studentMahv = document.getElementById("mahv").value;
        let studentName = document.getElementById("name").value;
        let studentBirthday = document.getElementById("birthday").value;
        let studentSex = document.getElementById("sex").value;
        let studentSclass = document.getElementById("sclass").value;
        let studentPhotoInput = document.getElementById("photo");

        if (studentMahv && studentName && studentBirthday && studentSex && studentSclass && studentPhotoInput.files.length > 0) {
            let reader = new FileReader();
            reader.onload = function (event) {
                let studentPhoto = event.target.result;
                let student = new Student(studentMahv, studentName, studentBirthday, studentSex, studentSclass, studentPhoto);
                array.push(student);

                document.getElementById("mahv").value = "";
                document.getElementById("name").value = "";
                document.getElementById("birthday").value = "";
                document.getElementById("sex").value = "";
                document.getElementById("sclass").value = "";
                document.getElementById("photo").value = "";

                alert("Thêm học viên thành công!");
                displayStudent(array);
            };
            reader.readAsDataURL(studentPhotoInput.files[0]);
        } else {
            alert("Vui lòng nhập đầy đủ thông tin!");
        }
    }
    function deleteStudent(i) {
        let check = confirm(`Bạn có chắc chắn muốn xóa ${array[i].getName()}?`);
        if (check) {
            array.splice(i, 1);
            alert("Xóa thành công!");
            displayStudent(array);
        }
    }

    let i = -1;

    function showUpdate(index) {
        i = index;
        document.getElementById("mahv").value = array[index].getMahv;
        document.getElementById("name").value = array[index].getName();
        document.getElementById("birthday").value = array[index].getBirthday();
        document.getElementById("sex").value = array[index].getSex();
        document.getElementById("sclass").value = array[index].getSclass();
        document.getElementById("photo").value = "";
    }

    function updateStudent() {
        let studentMahv = document.getElementById("mahv").value;
        let studentName = document.getElementById("name").value;
        let studentBirthday = document.getElementById("birthday").value;
        let studentSex = document.getElementById("sex").value;
        let studentSclass = document.getElementById("sclass").value;
        let studentPhotoInput = document.getElementById("photo");

        if (studentName && studentBirthday && studentSex && studentSclass) {
            let reader = new FileReader();
            reader.onload = function (event) {
                let studentPhoto = studentPhotoInput.files.length > 0 ? event.target.result : array[i].getPhoto();
                let student = new Student(studentName, studentBirthday, studentSex, studentSclass, studentPhoto);
                array[i] = student;

                document.getElementById("mahv").value = "";
                document.getElementById("name").value = "";
                document.getElementById("birthday").value = "";
                document.getElementById("sex").value = "";
                document.getElementById("sclass").value = "";
                document.getElementById("photo").value = "";

                alert("Update học viên thành công!");
                displayStudent(array);
            };
            if (studentPhotoInput.files.length > 0) {
                reader.readAsDataURL(studentPhotoInput.files[0]);
            } else {
                let studentPhoto = array[i].getPhoto();
                let student = new Student(studentName, studentBirthday, studentSex, studentSclass, studentPhoto);
                array[i] = student;

                document.getElementById("mahv").value = "";
                document.getElementById("name").value = "";
                document.getElementById("birthday").value = "";
                document.getElementById("sex").value = "";
                document.getElementById("sclass").value = "";
                document.getElementById("photo").value = "";

                alert("Update học viên thành công!");
                displayStudent(array);
            }
        } else {
            alert("Vui lòng nhập đầy đủ thông tin!");
        }
    }

    displayStudent(array);

</script>
</body>
</html>